<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Feedback | BloomCycle</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>

/* ===== RESET ===== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Poppins', sans-serif;
}

/* ===== BACKGROUND ===== */
body {
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(-45deg, #fbc2eb, #a6c1ee, #ff9a9e, #fad0c4);
  background-size: 400% 400%;
  animation: gradientBG 14s ease infinite;
  padding: 20px;
}

@keyframes gradientBG {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* ===== CARD ===== */
.container {
  width: 100%;
  max-width: 500px;
}

.card {
  background: rgba(255,255,255,0.2);
  backdrop-filter: blur(25px);
  padding: 45px 40px;
  border-radius: 25px;
  box-shadow: 0 25px 60px rgba(0,0,0,0.25);
  color: white;
  animation: fadeIn 0.8s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(25px); }
  to { opacity: 1; transform: translateY(0); }
}

.card h1 {
  text-align: center;
  font-weight: 700;
  margin-bottom: 10px;
}

.card p {
  text-align: center;
  margin-bottom: 30px;
  font-size: 14px;
  opacity: 0.9;
}

/* ===== INPUT GROUP ===== */
.input-group {
  position: relative;
  margin-bottom: 20px;
}

.input-group input,
.input-group textarea,
.input-group select {
  width: 100%;
  padding: 14px;
  border-radius: 14px;
  border: none;
  outline: none;
  background: rgba(255,255,255,0.3);
  color: white;
  font-size: 14px;
}

textarea {
  resize: none;
  min-height: 100px;
}

.input-group label {
  position: absolute;
  top: 14px;
  left: 15px;
  font-size: 14px;
  transition: 0.3s;
  pointer-events: none;
}

.input-group input:focus + label,
.input-group input:not(:placeholder-shown) + label,
.input-group textarea:focus + label,
.input-group textarea:not(:placeholder-shown) + label {
  top: -10px;
  left: 12px;
  font-size: 12px;
  background: rgba(0,0,0,0.3);
  padding: 2px 6px;
  border-radius: 6px;
}

/* ===== STAR RATING ===== */
.rating {
  display: flex;
  justify-content: center;
  margin-bottom: 20px;
}

.star {
  font-size: 28px;
  cursor: pointer;
  transition: 0.2s;
  color: rgba(255,255,255,0.4);
}

.star.active {
  color: gold;
}

/* Character counter */
.counter {
  text-align: right;
  font-size: 12px;
  margin-top: 5px;
  opacity: 0.8;
}

/* Button */
button {
  width: 100%;
  padding: 14px;
  border-radius: 14px;
  border: none;
  background: white;
  color: #a18cd1;
  font-weight: 600;
  cursor: pointer;
  transition: 0.3s;
}

button:hover {
  transform: translateY(-3px);
  box-shadow: 0 12px 25px rgba(0,0,0,0.25);
}

.message {
  text-align: center;
  font-size: 13px;
  margin-bottom: 15px;
  display: none;
}

.success { color: #d4ffcc; }
.error { color: #ffd6d6; }

</style>
</head>

<body>
  <a href ="dashboard.html"> Back to Dashboard</a>

<div class="container">
  <div class="card">
    <h1>Share Your Feedback ðŸŒ¸</h1>
    <p>Your experience helps us improve BloomCycle</p>

    <div id="messageBox" class="message"></div>

    <form id="feedbackForm">

      <div class="input-group">
        <input type="text" id="name" placeholder=" " required>
        <label>Your Name</label>
      </div>

      <div class="input-group">
        <input type="email" id="email" placeholder=" " required>
        <label>Email Address</label>
      </div>

      <div class="input-group">
        <select id="category" required>
          <option value="">Select Category</option>
          <option>App Design</option>
          <option>Features</option>
          <option>Bug Report</option>
          <option>Suggestion</option>
        </select>
      </div>

      <div class="rating" id="ratingStars">
        <span class="star" data-value="1">â˜…</span>
        <span class="star" data-value="2">â˜…</span>
        <span class="star" data-value="3">â˜…</span>
        <span class="star" data-value="4">â˜…</span>
        <span class="star" data-value="5">â˜…</span>
      </div>

      <div class="input-group">
        <textarea id="message" placeholder=" " maxlength="300" required></textarea>
        <label>Your Feedback</label>
        <div class="counter" id="charCount">0 / 300</div>
      </div>

      <button type="submit">Submit Feedback</button>

    </form>

  </div>
</div>

<script>

// Protect page
if (!localStorage.getItem("loggedInUser")) {
  window.location.href = "login.html";
}

let selectedRating = 0;
const stars = document.querySelectorAll(".star");
const messageBox = document.getElementById("messageBox");

stars.forEach(star => {
  star.addEventListener("click", () => {
    selectedRating = star.getAttribute("data-value");
    stars.forEach(s => s.classList.remove("active"));
    for (let i = 0; i < selectedRating; i++) {
      stars[i].classList.add("active");
    }
  });
});

const textarea = document.getElementById("message");
const charCount = document.getElementById("charCount");

textarea.addEventListener("input", () => {
  charCount.textContent = textarea.value.length + " / 300";
});

document.getElementById("feedbackForm").addEventListener("submit", function(e){
  e.preventDefault();

  if (selectedRating === 0)
    return showMessage("Please select a rating.", "error");

  const feedback = {
    name: document.getElementById("name").value.trim(),
    email: document.getElementById("email").value.trim(),
    category: document.getElementById("category").value,
    rating: selectedRating,
    message: textarea.value.trim(),
    user: localStorage.getItem("loggedInUser"),
    date: new Date().toLocaleString()
  };

  let feedbackList = JSON.parse(localStorage.getItem("feedbackList")) || [];
  feedbackList.push(feedback);
  localStorage.setItem("feedbackList", JSON.stringify(feedbackList));

  showMessage("Feedback submitted successfully!", "success");

  this.reset();
  stars.forEach(s => s.classList.remove("active"));
  selectedRating = 0;
  charCount.textContent = "0 / 300";
});

function showMessage(text, type) {
  messageBox.textContent = text;
  messageBox.className = "message " + type;
  messageBox.style.display = "block";
  setTimeout(() => messageBox.style.display = "none", 3000);
}

</script>

</body>
</html>
